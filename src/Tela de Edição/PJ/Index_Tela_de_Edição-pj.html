<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dashboard do Usuário</title>
    <link rel="stylesheet" href="/src/Tela de Edição/PJ/style_Tela_de_Edição-pj.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="/src/Tela de Edição/PJ/script_Tela_de_Edição-pj.js" defer></script>
  </head>
  <body>
  <div class="header">
    <header>
      <div class="left-group">
        <div class="menu-icon" onclick="toggleMenu()">
          <i class="fa-solid fa-bars menu-button"></i>
        </div>
        <div class="header-item">
          <img src="/src/imagens/Logo site.png" alt="Logo" class="logo" />
        </div>
      </div>

      <div class="center-group">
        <div class="search-container">
          <input type="text" id="search-bar" placeholder="Pesquisar..." class="search-bar" />
          <a class="search-button" id="search-button" href="#">
            <i class="fa-solid fa-magnifying-glass search-icon"></i>
          </a>
        </div>
      </div>

      <div class="right-group">
        <div class="user-area"> <!-- Área do usuário -->
          <a href="/src/Main/Main.html" class="minha-area-botao">Minha Área</a>
        </div>
        <!-- Ícone de usuário -->
        <div class="user-actions" id="perfil-logado">
          <a href="/src/perfil/perfil.html">
            <i class="fa-regular fa-circle-user"></i>
          </a>
        </div>
      </div>

        <!-- Menu dropdown -->
      <nav class="dropdown-menu" id="dropdownMenu">
        <ul id="menu">
          <!-- Perfil -->
          <li class="item-logged">
            <a class="perfil" href="/src/perfil/perfil.html">Perfil</a>
          </li>
          <li class="item-logged">
            <a href="/src/Main/Main.html">Minha Área</a>
          </li>
          <li class="item-logged">
            <a href="#" onclick="redirecionarCadastro()">Meu Dashboard</a>
          </li>
          <!-- Conteúdo Didático -->
          <li class="has-submenu">
            <a href="#">Conteúdo Didático</a>
            <ul class="submenu">
              <!-- Finanças Pessoais -->
              <li class="has-submenu item-pf">
                <a href="#">Finanças Corporativas</a>
                <ul class="submenu">
                  <li>
                    <a href="/src/conteudo-didatico/financas-corporativas/planejamento-financeiro/planejamento-financeiro.html"
                      onclick="registrarConteudoVisto('Planejamento Financeiro',
                      '/src/conteudo-didatico/financas-corporativas/planejamento-financeiro/planejamento-financeiro.html',
                      '/src/imagens/PlanejamentoFinanceiro.jpg')">
                      Planejamento Financeiro
                    </a>
                  </li>
                  <li>
                    <a href="/src/conteudo-didatico/financas-corporativas/orcamento-domestico/orcamento-domestico.html"
                      onclick="registrarConteudoVisto('Orçamento Corporativo',
                      '/src/conteudo-didatico/financas-corporativas/orcamento-domestico/orcamento-domestico.html',
                      '/src/imagens/OrcamentoDomestico.jpg')">
                      Orçamento Corporativo
                    </a>
                  </li>
                  <li>
                    <a href="/src/conteudo-didatico/financas-corporativas/controle-de-dividas/controle-de-dividas.html"
                      onclick="registrarConteudoVisto('Controle de Dívidas Corporativas',
                      '/src/conteudo-didatico/financas-corporativas/controle-de-dividas/controle-de-dividas.html',
                      '/src/imagens/ControleDividas.jpg')">
                      Controle de Dívidas Corporativas
                    </a>
                  </li>
                </ul>
              </li>

              <li class="has-submenu">
                <a href="#">Operações Bancárias</a>
                <ul class="submenu">
                  <li>
                    <a href="/src/conteudo-didatico/operacoes-bancarias/cartao-de-debito/cartao-de-debito.html"
                      onclick="registrarConteudoVisto('Cartão de Débito',
                      '/src/conteudo-didatico/operacoes-bancarias/cartao-de-debito/cartao-de-debito.html',
                      '/src/imagens/CartaoDeDebito.jpg')">
                      Cartão de Débito
                    </a>
                  </li>
                  <li>
                    <a href="/src/conteudo-didatico/operacoes-bancarias/cartao-de-credito/cartao-de-credito.html"
                      onclick="registrarConteudoVisto('Cartão de Crédito',
                      '/src/conteudo-didatico/operacoes-bancarias/cartao-de-credito/cartao-de-credito.html',
                      '/src/imagens/CartaodeCredito.png')">
                      Cartão de Crédito
                    </a>
                  </li>
                  <li>
                    <a href="/src/conteudo-didatico/operacoes-bancarias/emprestimo/emprestimo.html"
                      onclick="registrarConteudoVisto('Empréstimo',
                      '/src/conteudo-didatico/operacoes-bancarias/emprestimo/emprestimo.html',
                      '/src/imagens/Emprestimos.jpg')">
                      Empréstimos
                    </a>
                  </li>
                  <li>
                    <a href="/src/conteudo-didatico/operacoes-bancarias/financiamento/financiamento.html"
                      onclick="registrarConteudoVisto('Financiamento',
                      '/src/conteudo-didatico/operacoes-bancarias/financiamento/financiamento.html',
                      '/src/imagens/Financiamento.webp')">
                      Financiamento
                    </a>
                  </li>
                  <li>
                    <a href="/src/conteudo-didatico/operacoes-bancarias/taxas-e-tarifas/taxas-e-tarifas.html"
                      onclick="registrarConteudoVisto('Taxas e Tarifas',
                      '/src/conteudo-didatico/operacoes-bancarias/taxas-e-tarifas/taxas-e-tarifas.html',
                      '/src/imagens/TaxasTarifas.jpg')">
                      Taxas e Tarifas
                    </a>
                  </li>
                </ul>
              </li>

              <li class="has-submenu item-pf">
                <a href="#">Investimentos Corporativos</a>
                <ul class="submenu">
                  <li>
                    <a href="/src/conteudo-didatico/investimentos-corporativos/renda-fixa-pj/renda-fixa-pj.html"
                      onclick="registrarConteudoVisto('Renda Fixa',
                      '/src/conteudo-didatico/investimentos-corporativos/renda-fixa-pj/renda-fixa-pj.html',
                      '/src/imagens/RendaFixaPJ.jpg')">
                      Renda Fixa
                    </a>
                  </li>
                  <li>
                    <a href="/src/conteudo-didatico/investimentos-corporativos/renda-variavel-pj/renda-variavel-pj.html"
                      onclick="registrarConteudoVisto('Renda Variável',
                      '/src/conteudo-didatico/investimentos-corporativos/renda-variavel-pj/renda-variavel-pj.html',
                      '/src/imagens/RendaVariavelPFsub.jpg')">
                      Renda Variável
                    </a>
                  </li>
                  <li>
                    <a href="/src/conteudo-didatico/investimentos-corporativos/fundo-de-investimentos-pj/fundo-de-investimentos-pj.html"
                      onclick="registrarConteudoVisto('Fundo de Investimentos',
                      '/src/conteudo-didatico/investimentos-corporativos/fundo-de-investimentos-pj/fundo-de-investimentos-pj.html',
                      '/src/imagens/FundosDeInvestimentoPJ.jpg')">
                      Fundo de Investimentos
                    </a>
                  </li>
                </ul>
              </li>
            </ul>
          </li>
          <!-- FAQ -->
          <li class="item-logged">
            <a href="/src/Feedback/feedback.html">FAQ</a>
          </li>
          <!-- Sair -->
          <li class="item-logged">
            <a href="#" id="botao-sair">Sair</a>
          </li>
        </ul>
      </nav>
    </header>
  </div>


    <main class="main-content">
      <p id="dashboard-titulo">Dashboard da Empresa</p>

      <div class="filtros-dashboard">
        <div class="seletor-filtro">
          <label for="ano-filtro">Filtrar por Ano:</label>
          <select id="ano-filtro" onchange="atualizarFiltros()"></select>

          <label for="mes-filtro">Filtrar por Mês:</label>
          <select id="mes-filtro" onchange="atualizarFiltros()">
            <option value="">Todos os Meses</option>
            <option value="01">Janeiro</option>
            <option value="02">Fevereiro</option>
            <option value="03">Março</option>
            <option value="04">Abril</option>
            <option value="05">Maio</option>
            <option value="06">Junho</option>
            <option value="07">Julho</option>
            <option value="08">Agosto</option>
            <option value="09">Setembro</option>
            <option value="10">Outubro</option>
            <option value="11">Novembro</option>
            <option value="12">Dezembro</option>
          </select>

          <button class="Historico" onclick="openModal('historico')">
            Histórico
          </button>
        </div>
      </div>

      <div class="charts-grid">
        <div class="chart-container">
          <canvas id="pieChart"></canvas>
          <h3>Entradas vs Saídas</h3>
        </div>

        <div class="chart-container">
          <canvas id="lineChart"></canvas>
          <h3>Evolução do Saldo</h3>
        </div>

        <div class="chart-container">
          <canvas id="comparativeBarChart"></canvas>
          <h3>Comparação Mensal</h3>
        </div>
      </div>

      <div class="atualizar">
        <h3>Atualizar</h3>

        <div class="botoes-acao">
          <button class="Entradas" onclick="openModal('entradas')">Entradas</button>

          <button class="Saidas" onclick="openModal('saidas')">Saídas</button>

          <button class="Editar" onclick="openModal('editar')">Editar</button>

          <button class="Remover" onclick="openRemoveModal()">Remover Dados</button>

          <input
            type="submit"
            class="input-confirmar"
            value="Salvar alterações"
            onclick="renderDashboard()"
          />
        </div>
      </div>
    </main>

    <div class="overlay" id="overlay" onclick="closeModal()"></div>

    <div class="modal" id="modal-entradas">
      <h2>Atualização de Entrada</h2>
      <label>DATA</label><br />
      <input class="data" type="date" id="entrada-data" /><br />
      <label>VALOR DE ENTRADA</label><br />
      <input class="entrada" type="number" id="entrada-valor" /><br />

      <label>CATEGORIA</label><br />
      <select id="entrada-categoria">
        <option value="" disabled selected>Seleção</option>
        <option value="vendas_servicos">Vendas de Produtos/Serviços</option>
        <option value="recebimentos_clientes">Recebimentos de Clientes</option>
        <option value="investimentos_pj">Investimentos (PJ)</option>
        <option value="outras_entradas_pj">Outras Entradas</option>
      </select><br />
      <label>DESCRIÇÃO (Opcional)</label><br />
      <input class="descricao" type="text" id="entrada-descricao" /><br />
      <label>É RECORRENTE?</label><br />
      <input
        type="radio"
        id="entrada-recorrente-sim"
        name="entrada-recorrente"
        value="sim"
      />
      <label for="entrada-recorrente-sim">SIM</label>
      <input
        type="radio"
        id="entrada-recorrente-nao"
        name="entrada-recorrente"
        value="nao"
        checked
      />
      <label for="entrada-recorrente-nao">NÃO</label><br />

      <div
        id="entrada-opcoes-recorrentes"
        style="display: none; margin-top: 10px"
      >
        <label for="entrada-frequencia">Frequência:</label><br />
        <select id="entrada-frequencia">
          <option value="mensal">Mensal</option>
          <option value="semanal">Semanal</option>
          <option value="diaria">Diária</option>
          <option value="personalizada">Personalizada</option>
        </select><br />

        <label for="entrada-encerramento">Data de Encerramento:</label><br />
         <input type="date" id="entrada-encerramento" /><br />
      </div>

      <button onclick="salvarEntrada()">Salvar</button>
    </div>
    <div class="modal" id="modal-saidas">
      <h2>Atualização de Saída</h2>
      <label>DATA</label><br />
      <input class="data" type="date" id="saida-data" /><br />
      <label>VALOR DE SAÍDA</label><br />
      <input class="saida" type="number" id="saida-valor" /><br />

      <label>CATEGORIA</label><br />
      <select id="saida-categoria">
        <option value="" disabled selected>Seleção</option>
        <option value="folha_pagamento">Folha de Pagamento</option>
        <option value="aluguel_despesas_operacionais">Aluguel e Despesas</option>
        <option value="impostos_taxas">Impostos e Taxas</option>
        <option value="compras_fornecedores">Compras de Fornecedores</option>
        <option value="marketing_publicidade">Marketing e Publicidade</option>
        <option value="servicos_terceirizados">Serviços Terceirizados</option>
        <option value="outras_saidas_pj">Outras Saídas</option>
      </select><br />
      <label>DESCRIÇÃO (Opcional)</label><br />
      <input class="descricao" type="text" id="saida-descricao" /><br />

      <label>É RECORRENTE?</label><br />
      <input
        type="radio"
        id="saida-recorrente-sim"
        name="saida-recorrente"
        value="sim"
      />
      <label for="saida-recorrente-sim">SIM</label>
      <input
        type="radio"
        id="saida-recorrente-nao"
        name="saida-recorrente"
        value="nao"
        checked
      />
      <label for="saida-recorrente-nao">NÃO</label><br />

      <div
        id="saida-opcoes-recorrentes"
        style="display: none; margin-top: 10px"
      >
        <label for="saida-frequencia">Frequência:</label><br />
        <select id="saida-frequencia">
          <option value="mensal">Mensal</option>
          <option value="semanal">Semanal</option>
          <option value="diaria">Diária</option>
          <option value="personalizada">Personalizada</option>
        </select>
      </div>

      <button onclick="salvarSaida()">Salvar</button>
    </div>

    <div class="modal" id="modal-remover">
      <h2>Remover Dados</h2>
      <label for="tipo-remocao">Tipo de Dados:</label><br />
      <select id="tipo-remocao" onchange="loadTransactionsForRemoval()">
        <option value="" disabled selected>Selecione</option>
        <option value="entradas">Entrada</option>
        <option value="saidas">Saída</option>
      </select><br /><br />
      <div id="lista-transacoes-remocao" class="lista-transacoes-remocao">
      </div>
      <button onclick="confirmRemoveSelected()">Remover Selecionados</button>
    </div>

     <!--   MODAL EDITAR    -->
    <di class="modal" id="modal-editar">
        <h2>Editar Transação</h2>  
        <label for="tipo-edicao">TIPO DE TRANSAÇÃO</label><br />
        <select id="tipo-edicao" onchange="loadTransactionsForEdit()">
          <option value="">Selecione</option>
          <option value="entradas">Entradas</option>
          <option value="saidas">Saídas</option>
        </select><br />

        <div id="lista-transacoes-edicao" class="transaction-selection-list"> 
        </div>

        <div id="form-edicao" style="display: none">
          <h3>Detalhes da Transação</h3>
          <input type="hidden" id="edit-id" />
          <input type="hidden" id="edit-tipo" />

          <label for="edit-data">DATA</label><br />
          <input class="data" type="date" id="edit-data" /><br />

         <label for="edit-valor">Valor</label><br />
          <input class="entrada" type="number" id="edit-valor" step="0.01" /><br />

          <label for="edit-categoria">Categoria:</label><br />
          <select id="edit-categoria">  
            <option value="" disabled selected>Seleção</option>
            <option value="salario">Salário</option>
            <option value="investimentos">Investimentos</option>
            <option value="lucros">Lucros</option>
            <option value="outros_entrada">Outros</option>
          </select><br />

          <label for="edit-descricao">Descrição:</label><br />
          <input class="descricao" type="text" id="edit-descricao" /><br />
        
          <label>Recorrente:</label><br />
           <input
              type="radio"
              id="edit-recorrente-sim"
              name="edit-recorrente"
              value="sim"
            />
            <label for="edit-recorrente-sim">SIM</label>
            <input
              type="radio"
              id="edit-recorrente-nao"
              name="edit-recorrente"
              value="nao"
              checked
            />
            <label for="edit-recorrente-nao">NÃO</label><br />

          <!-- Campos adicionais se for recorrente -->
          <div id="edit-opcoes-recorrentes" style="display: none; margin-top: 10px">
            <label for="edit-frequencia">Frequência:</label><br />
            <select id="edit-frequencia">
              <option value="mensal">Mensal</option>
              <option value="semanal">Semanal</option>
              <option value="diaria">Diária</option>
              <option value="personalizada">Personalizada</option>
            </select> <br />

            <label for="edit-encerramento">Data de Encerramento:</label><br />
            <input type="date" id="edit-encerramento" /><br />
          </div>

          <button onclick="saveEditedTransaction()">Salvar</button>
        </div>
      </div>

    <div class="modal" id="modal-historico">
      <h2>Histórico de Transações</h2>
      <div class="seletor-filtro">
        <label for="historico-ano-filtro">Filtrar por Ano:</label>
        <select
          id="historico-ano-filtro"
          onchange="populateHistoricoModal()"
        ></select>
        <label for="historico-mes-filtro">Filtrar por Mês:</label>
        <select
          id="historico-mes-filtro"
          onchange="populateHistoricoModal()"
        >
          <option value="">Todos os Meses</option>
          <option value="01">Janeiro</option>
          <option value="02">Fevereiro</option>
          <option value="03">Março</option>
          <option value="04">Abril</option>
          <option value="05">Maio</option>
          <option value="06">Junho</option>
          <option value="07">Julho</option>
          <option value="08">Agosto</option>
          <option value="09">Setembro</option>
          <option value="10">Outubro</option>
          <option value="11">Novembro</option>
          <option value="12">Dezembro</option>
        </select>
      </div>
      <div id="historico-lista" class="historico-lista">
        <div class="historico-colunas">
          <div class="coluna-entradas">
            <h3>Entradas</h3>
            <ul id="lista-entradas">
              <p>Carregando histórico de entradas...</p>
            </ul>
          </div>
          <div class="coluna-saidas">
            <h3>Saídas</h3>
            <ul id="lista-saidas">
              <p>Carregando histórico de saídas...</p>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>